import numpy as np
import csv

''' 
Here we took raw data from an IDL file, which is used to determine the 
threshold of signal detection of each pixel of the electronics, and stored it 
in a csv file. This code is only to execute once if we haven't created or 
accidentally deleted the 'seuils.csv' file. Its purpose is just to make the 
calculations only once and store the data properly.
'''

basse = np.zeros(256)
haute = np.zeros(256)
basse[0] = 4490
basse[1] = 4500
basse[2] = 4520
basse[3] = 4515
basse[4] = 4475
basse[5] = 4505
basse[6] = 4475
basse[7] = 4480
basse[8] = 4545
basse[9] = 4505
basse[10] = 4440
basse[11] = 4525
basse[12] = 4495
basse[13] = 4465
basse[14] = 4490
basse[15] = 4500
basse[15+1] = 4480
basse[15+2] = 4460
basse[15+3] = 4525
basse[15+4] = 4480
basse[15+5] = 4500
basse[15+6] = 4525
basse[15+7] = 4520
basse[15+8] = 4545
basse[15+9] = 4525
basse[15+10] = 4475
basse[15+11] = 4540
basse[15+12] = 4540
basse[15+13] = 4560
basse[15+14] = 4455
basse[15+15] = 4490
basse[15+16] = 4535
basse[32+0] = 4440
basse[32+1] = 4525
basse[32+2] = 4490
basse[32+3] = 4485
basse[32+4] = 4515
basse[32+5] = 4500
basse[32+6] = 4540
basse[32+7] = 4445
basse[32+8] = 4490
basse[32+9] = 4505
basse[32+10] = 4495
basse[32+11] = 4475
basse[32+12] = 4495
basse[32+13] = 4480
basse[32+14] = 4510
basse[32+15] = 4490
basse[47+1] = 4550
basse[47+2] = 4485
basse[47+3] = 4510
basse[47+4] = 4465
basse[47+5] = 4470
basse[47+6] = 4495
basse[47+7] = 4520
basse[47+8] = 4530
basse[47+9] = 4545
basse[47+10] = 4455
basse[47+11] = 4475
basse[47+12] = 4515
basse[47+13] = 4455
basse[47+14] = 4515
basse[47+15] = 4500
basse[47+16] = 4510
basse[64+0] = 4440
basse[64+1] = 4465
basse[64+2] = 4490
basse[64+3] = 4475
basse[64+4] = 4435
basse[64+5] = 4445
basse[64+6] = 4475
basse[64+7] = 4460
basse[64+8] = 4480
basse[64+9] = 4480
basse[64+10] = 4495
basse[64+11] = 4490
basse[64+12] = 4445
basse[64+13] = 4520
basse[64+14] = 4470
basse[64+15] = 4515
basse[80+0] = 4515
basse[80+1] = 4495
basse[80+2] = 4455
basse[80+3] = 4510
basse[80+4] = 4445
basse[80+5] = 4495
basse[80+6] = 4480
basse[80+7] = 4445
basse[80+8] = 4510
basse[80+9] = 4465
basse[80+10] = 4485
basse[80+11] = 4480
basse[80+12] = 4470
basse[80+13] = 4445
basse[80+14] = 4460
basse[80+15] = 4445
basse[96+0] = 4410
basse[96+1] = 4462
basse[96+2] = 4435
basse[96+3] = 4430
basse[96+4] = 4475
basse[96+5] = 4505
basse[96+6] = 4485
basse[96+7] = 4440
basse[96+8] = 4445
basse[96+9] = 4405
basse[96+10] = 4420
basse[96+11] = 4445
basse[96+12] = 4480
basse[96+13] = 4455
basse[96+14] = 4470
basse[96+15] = 4480
basse[112+0] = 4460
basse[112+1] = 4470
basse[112+2] = 4465
basse[112+3] = 4475
basse[112+4] = 4450
basse[112+5] = 4485
basse[112+6] = 4460
basse[112+7] = 4440
basse[112+8] = 4420
basse[112+9] = 4465
basse[112+10] = 4445
basse[112+11] = 4460
basse[112+12] = 4425
basse[112+13] = 4440
basse[112+14] = 4470
basse[112+15] = 4515
basse[128+0] = 4505
basse[128+1] = 4455
basse[128+2] = 4445
basse[128+3] = 4490
basse[128+4] = 4475
basse[128+5] = 4445
basse[128+6] = 4475
basse[128+7] = 4465
basse[128+8] = 4425
basse[128+9] = 4465
basse[128+10] = 4490
basse[128+11] = 4450
basse[128+12] = 4440
basse[128+13] = 4415
basse[128+14] = 4495
basse[128+15] = 4450
basse[144+0] = 4505
basse[144+1] = 4470
basse[144+2] = 4470
basse[144+3] = 4465
basse[144+4] = 4465
basse[144+5] = 4440
basse[144+6] = 4460
basse[144+7] = 4460
basse[144+8] = 4490
basse[144+9] = 4485
basse[144+10] = 4480
basse[144+11] = 4460
basse[144+12] = 4475
basse[144+13] = 4455
basse[144+14] = 4435
basse[144+15] = 4460
basse[160+0] = 4440
basse[160+1] = 4420
basse[160+2] = 4490
basse[160+3] = 4455
basse[160+4] = 4440
basse[160+5] = 4465
basse[160+6] = 4465
basse[160+7] = 4460
basse[160+8] = 4470
basse[160+9] = 4460
basse[160+10] = 4450
basse[160+11] = 4465
basse[160+12] = 4490
basse[160+13] = 4490
basse[160+14] = 4490
basse[160+15] = 4465
basse[176+0] = 4450
basse[176+1] = 4470
basse[176+2] = 4455
basse[176+3] = 4485
basse[176+4] = 4440
basse[176+5] = 4505
basse[176+6] = 4462
basse[176+7] = 4475
basse[176+8] = 4515
basse[176+9] = 4480
basse[176+10] = 4470
basse[176+11] = 4485
basse[176+12] = 4495
basse[176+13] = 4465
basse[176+14] = 4485
basse[176+15] = 4460
basse[192+0] = 4500
basse[192+1] = 4425
basse[192+2] = 4502
basse[192+3] = 4545
basse[192+4] = 4470
basse[192+5] = 4505
basse[192+6] = 4510
basse[192+7] = 4540
basse[192+8] = 4500
basse[192+9] = 4555
basse[192+10] = 4530
basse[192+11] = 4515
basse[192+12] = 4467
basse[192+13] = 4485
basse[192+14] = 4485
basse[192+15] = 4537
basse[208+0] = 4545
basse[208+1] = 4510
basse[208+2] = 4505
basse[208+3] = 4495
basse[208+4] = 4480
basse[208+5] = 4500
basse[208+6] = 4485
basse[208+7] = 4490
basse[208+8] = 4475
basse[208+9] = 4450
basse[208+10] = 4495
basse[208+11] = 4505
basse[208+12] = 4500
basse[208+13] = 4507
basse[208+14] = 4512
basse[208+15] = 4475
basse[224+0] = 4500
basse[224+1] = 4500
basse[224+2] = 4445
basse[224+3] = 4510
basse[224+4] = 4480
basse[224+5] = 4470
basse[224+6] = 4450
basse[224+7] = 4485
basse[224+8] = 4510
basse[224+9] = 4465
basse[224+10] = 4475
basse[224+11] = 4470
basse[224+12] = 4430
basse[224+13] = 4545
basse[224+14] = 4510
basse[224+15] = 4462
basse[240+0] = 4510
basse[240+1] = 4485
basse[240+2] = 4475
basse[240+3] = 4465
basse[240+4] = 4485
basse[240+5] = 4505
basse[240+6] = 4455
basse[240+7] = 4475
basse[240+8] = 4495
basse[240+9] = 4485
basse[240+10] = 4455
basse[240+11] = 4465
basse[240+12] = 4485
basse[240+13] = 4510
basse[240+14] = 4487
basse[240+15] = 4445

haute[0] = 4900
haute[1] = 4910
haute[2] = 4940
haute[3] = 4925
haute[4] = 4985
haute[5] = 4920
haute[6] = 4890
haute[7] = 4895
haute[8] = 4965
haute[9] = 4930
haute[10] = 4860
haute[11] = 4945
haute[12] = 4915
haute[13] = 4885
haute[14] = 4930
haute[15] = 4925
haute[16+0] = 4885
haute[16+1] = 4870
haute[16+2] = 4940
haute[16+3] = 4895
haute[16+4] = 4915
haute[16+5] = 4945
haute[16+6] = 4940
haute[16+7] = 4970
haute[16+8] = 4930
haute[16+9] = 4895
haute[16+10] = 4965
haute[16+11] = 4960
haute[16+12] = 4980
haute[16+13] = 4875
haute[16+14] = 4915
haute[16+15] = 4960
haute[32+0] = 4970
haute[32+1] = 4965
haute[32+2] = 4930
haute[32+3] = 4920
haute[32+4] = 4960
haute[32+5] = 4940
haute[32+6] = 4985
haute[32+7] = 4890
haute[32+8] = 4935
haute[32+9] = 4950
haute[32+10] = 4940
haute[32+11] = 4920
haute[32+12] = 4945
haute[32+13] = 4925
haute[32+14] = 4960
haute[32+15] = 4940
haute[48+0] = 4985
haute[48+1] = 4925
haute[48+2] = 4945
haute[48+3] = 4905
haute[48+4] = 4910
haute[48+5] = 4940
haute[48+6] = 4970
haute[48+7] = 4975
haute[48+8] = 4990
haute[48+9] = 4905
haute[48+10] = 4925
haute[48+11] = 4965
haute[48+12] = 4900
haute[48+13] = 4965
haute[48+14] = 4945
haute[48+15] = 4965
haute[64+0] = 4850
haute[64+1] = 4880
haute[64+2] = 4900
haute[64+3] = 4885
haute[64+4] = 4845
haute[64+5] = 4855
haute[64+6] = 4890
haute[64+7] = 4880
haute[64+8] = 4895
haute[64+9] = 4895
haute[64+10] = 4915
haute[64+11] = 4910
haute[64+12] = 4865
haute[64+13] = 4945
haute[64+14] = 4895
haute[64+15] = 4940
haute[80+0] = 4920
haute[80+1] = 4910
haute[80+2] = 4870
haute[80+3] = 4920
haute[80+4] = 4860
haute[80+5] = 4910
haute[80+6] = 4895
haute[80+7] = 4855
haute[80+8] = 4930
haute[80+9] = 4885
haute[80+10] = 4900
haute[80+11] = 4895
haute[80+12] = 4890
haute[80+13] = 4865
haute[80+14] = 4885
haute[80+15] = 4865
haute[96+0] = 4820
haute[96+1] = 4875
haute[96+2] = 4850
haute[96+3] = 4845
haute[96+4] = 4885
haute[96+5] = 4920
haute[96+6] = 4895
haute[96+7] = 4855
haute[96+8] = 4860
haute[96+9] = 4815
haute[96+10] = 4840
haute[96+11] = 4865
haute[96+12] = 4900
haute[96+13] = 4875
haute[96+14] = 4885
haute[96+15] = 4905
haute[112+0] = 4875
haute[112+1] = 4880
haute[112+2] = 4870
haute[112+3] = 4885
haute[112+4] = 4860
haute[112+5] = 4900
haute[112+6] = 4875
haute[112+7] = 4855
haute[112+8] = 4830
haute[112+9] = 4880
haute[112+10] = 4860
haute[112+11] = 4875
haute[112+12] = 4850
haute[112+13] = 4860
haute[112+14] = 4890
haute[112+15] = 4940
haute[128+0] = 4950
haute[128+1] = 4890
haute[128+2] = 4880
haute[128+3] = 4930
haute[128+4] = 4920
haute[128+5] = 4885
haute[128+6] = 4920
haute[128+7] = 4910
haute[128+8] = 4870
haute[128+9] = 4915
haute[128+10] = 4940
haute[128+11] = 4905
haute[128+12] = 4895
haute[128+13] = 4865
haute[128+14] = 4950
haute[128+15] = 4912
haute[144+0] = 4945
haute[144+1] = 4920
haute[144+2] = 4915
haute[144+3] = 4905
haute[144+4] = 4910
haute[144+5] = 4885
haute[144+6] = 4905
haute[144+7] = 4905
haute[144+8] = 4940
haute[144+9] = 4940
haute[144+10] = 4930
haute[144+11] = 4915
haute[144+12] = 4930
haute[144+13] = 4905
haute[144+14] = 4890
haute[144+15] = 4915
haute[160+0] = 4880
haute[160+1] = 4845
haute[160+2] = 4920
haute[160+3] = 4885
haute[160+4] = 4875
haute[160+5] = 4900
haute[160+6] = 4900
haute[160+7] = 4900
haute[160+8] = 4905
haute[160+9] = 4905
haute[160+10] = 4890
haute[160+11] = 4905
haute[160+12] = 4935
haute[160+13] = 4930
haute[160+14] = 4940
haute[160+15] = 4910
haute[176+0] = 4880
haute[176+1] = 4900
haute[176+2] = 4880
haute[176+3] = 4920
haute[176+4] = 4870
haute[176+5] = 4940
haute[176+6] = 4890
haute[176+7] = 4915
haute[176+8] = 4955
haute[176+9] = 4920
haute[176+10] = 4910
haute[176+11] = 4925
haute[176+12] = 4940
haute[176+13] = 4905
haute[176+14] = 4935
haute[176+15] = 4910
haute[192+0] = 4935
haute[192+1] = 4855
haute[192+2] = 4935
haute[192+3] = 4980
haute[192+4] = 4910
haute[192+5] = 4947
haute[192+6] = 4950
haute[192+7] = 4980
haute[192+8] = 4940
haute[192+9] = 4995
haute[192+10] = 4975
haute[192+11] = 4960
haute[192+12] = 4915
haute[192+13] = 4935
haute[192+14] = 4930
haute[192+15] = 4985
haute[208+0] = 4985
haute[208+1] = 4945
haute[208+2] = 4940
haute[208+3] = 4930
haute[208+4] = 4922
haute[208+5] = 4938
haute[208+6] = 4925
haute[208+7] = 4930
haute[208+8] = 4915
haute[208+9] = 4892
haute[208+10] = 4945
haute[208+11] = 4955
haute[208+12] = 4945
haute[208+13] = 4955
haute[208+14] = 4965
haute[208+15] = 4925
haute[224+0] = 4920
haute[224+1] = 4910
haute[224+2] = 4860
haute[224+3] = 4920
haute[224+4] = 4890
haute[224+5] = 4890
haute[224+6] = 4865
haute[224+7] = 4900
haute[224+8] = 4925
haute[224+9] = 4885
haute[224+10] = 4900
haute[224+11] = 4885
haute[224+12] = 4845
haute[224+13] = 4960
haute[224+14] = 4930
haute[224+15] = 4880
haute[240+0] = 4920
haute[240+1] = 4900
haute[240+2] = 4895
haute[240+3] = 4880
haute[240+4] = 4885
haute[240+5] = 4915
haute[240+6] = 4865
haute[240+7] = 4885
haute[240+8] = 4915
haute[240+9] = 4910
haute[240+10] = 4875
haute[240+11] = 4890
haute[240+12] = 4905
haute[240+13] = 4930
haute[240+14] = 4915
haute[240+15] = 4867

coeff = 1.9797981

seuils = np.zeros(256)
for i in range(256):
    seuils[i] = (coeff*basse[i] - haute[i])/(coeff-1)

with open('seuils.csv', 'w', newline='') as f:
    writer = csv.writer(f)
    writer.writerow(seuils)
